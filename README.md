

# detektDx
  **detektDx** is a converter for the output format of **detekt** to a property file compatible with **Dx-Platform**. **detektDx** uses currently **detekt v.1.16.0**.

# Your First Run In Two Steps
## 1. Clone [detekt](https://github.com/detekt/detekt) with Git

    git clone https://github.com/detekt/detekt.git
## 2. Execute:
    sudo docker run -v $PWD/detekt:/detektDx/detekt -v $PWD/dx-platform_properties:/detektDx/dx-platform_properties b12koe1/bogdanbc-ces-repository bash -c "kotlin DetektDxKt detekt"
 **The Dx-Platform output property file must be in the directory dx-platform_properties**. This property file can be imported in the Dx-Platform.

# Features
 1. **Compability**: with Dx-Platform: based on the output of the detekt static analyzer a property file that can be understood by Dx-Platform is generated
 2. **Performance**: detektDx uses the detekt flag called **--parallel** for a better performance for most files on most machines
 3. **Portability**: by using Docker detektDx can **run on any machine** without having to try too much to respect other requirements

# Output Description
* The output is a list with 4-tuples: **category**, **file**, **name**, and **value**.
* There is only one **category**: issues-by-detekt-1.16.0
* The **file** is a relative path to a file.
* There are two types of **names**: ending with a number and not ending with a number. A name represents an issue found by detekt, e.g. . The appended number, if exists, it represents the minimum number of times the issue has to be in a file for detekt to warn about the issue.
* The **value** represents the number of times detekt finds the issue in the file.

# Requirements
 ## 1. First
 ***The Kotlin project that is going to be analyzed*** should be where the Docker image is going to run.
 ## 2. **Docker**
 If Docker is installed (if it is not, [install it](https://www.docker.com/get-started) and there is a project to be analyzed in a directory D, the Docker image can run in that directory D. The Docker image is [b12koe1/bogdanbc-ces-repository](https://hub.docker.com/r/b12koe1/bogdanbc-ces-repository) . The generic form of the command to be executed is:

    sudo docker run -v $PWD/<project_to_be_analyzed>:/detektDx/<project_to_be_analyzed> -v $PWD/dx-platform_properties:/detektDx/dx-platform_properties b12koe1/bogdanbc-ces-repository bash -c "kotlin DetektDxKt detekt"

## 3. A Kotlin project for analysis
Here are two Kotlin projects as examples that can be used for analysis.

### Example 1: [kotlinx.coroutines](https://github.com/Kotlin/kotlinx.coroutines)
  This could be cloned:

    git clone https://github.com/Kotlin/kotlinx.coroutines.git
### Example 2: [detekt](https://github.com/detekt/detekt)
  This could be cloned:

     git clone https://github.com/detekt/detekt.git
## 4. Dx-Platform
### Download [Dx-Platform](https://drive.google.com/file/d/1bC4ZJ_RVcGJezAHZ45AIF8UKAh3gG3NY/view)


 1. Start Dx-Platform by following the instructions from the Dx-Platform's README.md found in:

    dx-platform-2.0.0-ALPHA/.dx-platform/

 2. Create a new Dx-Platform project with the downloaded Kotlin project
 3. Check whether the Kotlin files are labeled with Kotlin. If the Kotlin files are not labeled with Kotlin add label for them.

# Detailed Example

 1. **Run detektDx** with the downloaded Kotlin project **KP1** by running its container [container](https://hub.docker.com/r/b12koe1/bogdanbc-ces-repository)
 2. **Wait** until detektDx completes its execution
 3. (***Optional***) **Check** the directory below to see the generated file:
    `/dx-platform_properties`
    A file **F** must have been generated in this directory. This file must have the name:
    `b.json`
 4. **Import** this file **F** to **Dx-Platform** by following the next steps
 5. Select **Configure** the **Dx-Platform project** for the Kotlin project **KP1**
 6. Select **Upload Properties**
 7. Navigate to the tab **Upload Property Files**
 8. **Import** the generated property file in Dx-Platform by uploading the file **F**
 9. Start **Exploring** by selecting **Explore Project**
10. Navigate to **System Map**
11. In the combo box for **Code Activity** select **issues-by-detekt-1.16.0** (this is the category of all properties currently generated by detektDx.
12. Depending on the issues detected by detekt, various labels can be selected. Examples of such labels are: **MagicNumber**, **EmptyFunctionBlock**, **ComplexMethod15**. Note that some label are followed by a number. That number means that starting with the value of that number the specific issue associated with the number will be reported. For example, if the complexity of a method is >=15, then an issue ComplexMethod15 will be reported. 2 images of **System Map**, each one for a different Kotlin project, below:
```
![Image for **detekt**:](/images/system_map_after_importing_generated_property_file_for_dk_project.png)
```
```
![mage for **kotlinx.coroutines**:](/images/system_map_after_importing_generated_property_file_for_kco_project.png)
```
# Preconditoins
 1. **detektDx** must receive ***exactly one argument***
 2. this argument must be ***exactly one relative path*** to the Kotlin project to be analyzed
# Contributors
* Bogdan Bogorodea
# Acknowledgments
  * **detekt**. **detektDx** uses **detekt** for the hard work of static analysis of Kotlin projects.
  * **Dx-Platform**. **Dx-Platform** does wonderful things with the output of **detektDx**. Without **Dx-Platform** the conversion would have not be that useful.
